<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 17:31:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SHDP-103/SHDP-103.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SHDP-103] Avoid calling FileSystem.close()</title>
                <link>https://jira.spring.io/browse/SHDP-103</link>
                <project id="10801" key="SHDP">Spring for Apache Hadoop</project>
                    <description>&lt;p&gt;Newer hadoops have implemented FileSystem object cache. it means that calling Filesystem.get() didnt always return new object, it prefers to return cached instance. Problem is that after calling fs.close() no other work with hdfs is possible.&lt;/p&gt;

&lt;p&gt;I am using spring context in mapper task. in xml i have standard:&lt;br/&gt;
&amp;lt;hadoop:configuration/&amp;gt;&lt;br/&gt;
&amp;lt;hadoop:file-system/&amp;gt;&lt;/p&gt;

&lt;p&gt;after finishing my task, i am closing spring context and this closes filesystem too. This is problem because hadoop mapper can not finish its cleanup tasks and marks entire task attempt as FAILED.&lt;/p&gt;

&lt;p&gt;I need you to add another boolean property to &lt;a href=&quot;https://github.com/SpringSource/spring-hadoop/blob/master/src/main/java/org/springframework/data/hadoop/fs/FileSystemFactoryBean.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/SpringSource/spring-hadoop/blob/master/src/main/java/org/springframework/data/hadoop/fs/FileSystemFactoryBean.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;called close (default true). If set to false then filesystem is not closed when spring context is shutting down.&lt;/p&gt;

&lt;p&gt;2012-08-29 17:55:05,670 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.context.support.ClassPathXmlApplicationContext: Closing org.springframework.context.support.ClassPathXmlApplicationContext@67148603: startup date &lt;span class=&quot;error&quot;&gt;&amp;#91;Wed Aug 29 17:53:44 CEST 2012&amp;#93;&lt;/span&gt;; root of context hierarchy&lt;br/&gt;
2012-08-29 17:55:05,674 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.context.support.DefaultLifecycleProcessor: Stopping beans in phase 0&lt;br/&gt;
2012-08-29 17:55:05,724 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.context.support.DefaultLifecycleProcessor: Stopping beans in phase 0&lt;br/&gt;
2012-08-29 17:55:05,725 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.beans.factory.support.DefaultListableBeanFactory: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@4adf2940: defining beans &lt;span class=&quot;error&quot;&gt;&amp;#91;classloader-fix,default,fetch,generate,parse,index&amp;#93;&lt;/span&gt;; root of factory hierarchy&lt;br/&gt;
2012-08-29 17:55:05,725 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.context.support.ClassPathXmlApplicationContext: Closing ApplicationContext &apos;generate&apos;: startup date &lt;span class=&quot;error&quot;&gt;&amp;#91;Wed Aug 29 17:54:15 CEST 2012&amp;#93;&lt;/span&gt;; root of context hierarchy&lt;br/&gt;
2012-08-29 17:55:05,746 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.context.support.DefaultLifecycleProcessor: Stopping beans in phase 0&lt;br/&gt;
2012-08-29 17:55:05,746 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.beans.factory.support.DefaultListableBeanFactory: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@16ad339b: defining beans &lt;a href=&quot;#0,org.springframework.cache.interceptor.CacheInterceptor#0,org.springframework.cache.config.internalCacheAdvisor,pluginmanager-skeleton,classloader-fix,jsr303validator,pluginmanager,nutchunsort,selector-mapper,selector-reducer,selector-partitioner,partition-mode,schedule,generate,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0&quot;&gt;org.springframework.data.hadoop.mapreduce.MapReducePropertyEditorRegistrar.ns.registration,hadoopConfiguration,hadoopFs,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,urlfilters,urlnormalizers,parsers,parsefilters,mimedetectors,encodingdetectors,indexingfilters,indexwriters,protocols,scoringfilters,signatures,cacheManager,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.cache.annotation.AnnotationCacheOperationSource#0,org.springframework.cache.interceptor.CacheInterceptor#0,org.springframework.cache.config.internalCacheAdvisor,pluginmanager-skeleton,classloader-fix,jsr303validator,pluginmanager,nutchunsort,selector-mapper,selector-reducer,selector-partitioner,partition-mode,schedule,generate,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0&lt;/a&gt;; root of factory hierarchy&lt;br/&gt;
2012-08-29 17:55:05,754 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.apache.nutch.plugin.PluginManager: Closing ApplicationContext &apos;pluginmanager&apos;: startup date &lt;span class=&quot;error&quot;&gt;&amp;#91;Wed Aug 29 17:54:34 CEST 2012&amp;#93;&lt;/span&gt;; parent: ApplicationContext &apos;generate&apos;&lt;br/&gt;
2012-08-29 17:55:05,754 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.springframework.beans.factory.support.DefaultListableBeanFactory: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@4c825cf3: defining beans &lt;a href=&quot;#0&quot;&gt;lib-domutils,creativecommons,creativecommons/index,creativecommons/parse,encoding-icu,encoding-icu/detector,feed,feed/parse,feed/index,htmlparser-neko,htmlparser-neko/dombuilder,htmlparser-tagsoup,htmlparser-tagsoup/dombuilder,index-anchor,index-anchor/index,index-basic,index-basic/index,index-more/index,index-more,index-static,index-static/index,language-identifier,language-identifier/parse,language-identifier/index,lib-crawlercommons,robotstxt,robotstxt/manager,lib-http,lib-regex-filter,lib-robots,lib-robots/parser,lib-xml,microformats-reltag,microformats-reltag/index,microformats-reltag/parse,mime-tikamagic,mime-tikamagic/detect,parse-ext,parse-ext/parser,parse-html,parse-html/parse,parse-js,parse-js/parse,parse-swf,parse-swf/parse,parse-tika,parse-tika/parse,parse-zip,parse-zip/parse,protocol-file,protocol-file/file,protocol-ftp,protocol-ftp/ftp,protocol-http,protocol-http/http,protocol-httpclient,protocol-httpclient/http,protocol-httpclient/https,scoring-link,scoring-link/scoring,scoring-opic,scoring-opic/score,subcollection,subcollection/index,subcollection/filter,tld,tld/index,tld/score,urlfilter-automaton,urlfilter-automaton/filter,urlfilter-domain,urlfilter-domain/filter,urlfilter-prefix,urlfilter-prefix/filter,urlfilter-regex,urlfilter-regex/filter,urlfilter-suffix,urlfilter-suffix/filter,urlfilter-validator,urlfilter-validator/filter,urlmeta,urlmeta/score,urlmeta/index,urlnormalizer-basic,urlnormalizer-basic/normalize,urlnormalizer-pass,urlnormalizer-pass/normalize,urlnormalizer-regex,urlnormalizer-regex/normalize,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,jsr303validator,cz-domainfilter,cz-domains-res,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0&lt;/a&gt;; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@16ad339b&lt;br/&gt;
2012-08-29 17:55:06,241 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.apache.hadoop.security.UserGroupInformation: PriviledgedActionException as:crawler (auth:SIMPLE) cause:java.io.IOException: Filesystem closed&lt;br/&gt;
2012-08-29 17:55:06,242 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; org.apache.hadoop.mapred.YarnChild: Exception running child : java.io.IOException: Filesystem closed&lt;br/&gt;
	at org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:371)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DFSInputStream.close(DFSInputStream.java:453)&lt;br/&gt;
	at java.io.FilterInputStream.close(FilterInputStream.java:172)&lt;br/&gt;
	at org.apache.hadoop.io.SequenceFile$Reader.close(SequenceFile.java:1916)&lt;br/&gt;
	at org.apache.hadoop.mapreduce.lib.input.SequenceFileRecordReader.close(SequenceFileRecordReader.java:105)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask$NewTrackingRecordReader.close(MapTask.java:463)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:729)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:332)&lt;br/&gt;
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:154)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:416)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1177)&lt;br/&gt;
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:149)&lt;/p&gt;</description>
                <environment>Hadoop - 2 / CDH4</environment>
        <key id="45200">SHDP-103</key>
            <summary>Avoid calling FileSystem.close()</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://jira.spring.io/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://jira.spring.io/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="costin">Costin Leau</assignee>
                                    <reporter username="hsn">Radim Kolar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Aug 2012 09:41:50 +0000</created>
                <updated>Fri, 31 Aug 2012 15:25:04 +0000</updated>
                            <resolved>Thu, 30 Aug 2012 08:28:05 +0000</resolved>
                                    <version>1.0.0.M2</version>
                                    <fixVersion>1.0.0.RC1</fixVersion>
                                    <component>FS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="83019" author="hsn" created="Wed, 29 Aug 2012 11:40:48 +0000"  >&lt;p&gt;after it gets fixed make snapshot and i will test it. i need this fix soon, it blocks my work.&lt;/p&gt;</comment>
                            <comment id="83024" author="hsn" created="Wed, 29 Aug 2012 13:37:04 +0000"  >&lt;p&gt;Proposed xml syntax&lt;/p&gt;

&lt;p&gt;&amp;lt;hadoop:file-system close=&quot;false&quot; /&amp;gt;&lt;/p&gt;</comment>
                            <comment id="83070" author="costin" created="Thu, 30 Aug 2012 08:28:05 +0000"  >&lt;p&gt;Fixed in master - nighly build pushed.&lt;/p&gt;</comment>
                            <comment id="83132" author="hsn" created="Fri, 31 Aug 2012 15:25:04 +0000"  >&lt;p&gt;works fine.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 Aug 2012 08:28:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32122</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05tbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33958</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31822</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>